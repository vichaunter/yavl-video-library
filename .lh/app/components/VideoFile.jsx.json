{
    "sourceFile": "app/components/VideoFile.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1708264776530,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1708264803928,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -15,8 +15,9 @@\n import { PlaySquareFilled } from \"@ant-design/icons\";\r\n import notfoundSrc from \"../images/flagging/notfound.jpg\";\r\n import db from \"../services/db\";\r\n import store from \"../services/store\";\r\n+import TraktIcon from \"./icons/TraktIcon\";\r\n \r\n const StyledVideo = styled(Col)`\r\n   position: relative;\r\n \r\n@@ -204,9 +205,9 @@\n       <div className=\"info\">\r\n         {info ? renderInformations(info) : <span>{name}</span>}\r\n         {info?.title && (\r\n           <button className=\"trakt\" onClick={handleOpenTraktr}>\r\n-            {trakticon}\r\n+            <TraktIcon />\r\n           </button>\r\n         )}\r\n         <PlaySquareFilled className=\"play\" onClick={handleOpenVideo} />\r\n       </div>\r\n"
                },
                {
                    "date": 1708264870923,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -15,9 +15,9 @@\n import { PlaySquareFilled } from \"@ant-design/icons\";\r\n import notfoundSrc from \"../images/flagging/notfound.jpg\";\r\n import db from \"../services/db\";\r\n import store from \"../services/store\";\r\n-import TraktIcon from \"./icons/TraktIcon\";\r\n+import TraktIcon from \"./icons/trakticon\";\r\n \r\n const StyledVideo = styled(Col)`\r\n   position: relative;\r\n \r\n@@ -205,9 +205,9 @@\n       <div className=\"info\">\r\n         {info ? renderInformations(info) : <span>{name}</span>}\r\n         {info?.title && (\r\n           <button className=\"trakt\" onClick={handleOpenTraktr}>\r\n-            <TraktIcon />\r\n+            {trakticon}\r\n           </button>\r\n         )}\r\n         <PlaySquareFilled className=\"play\" onClick={handleOpenVideo} />\r\n       </div>\r\n"
                }
            ],
            "date": 1708264776530,
            "name": "Commit-0",
            "content": "import React, { useEffect, useState } from \"react\";\r\nimport { basename } from \"path\";\r\nimport SoundOutlined from \"@ant-design/icons/lib/icons/SoundOutlined\";\r\nimport MessageOutlined from \"@ant-design/icons/lib/icons/MessageOutlined\";\r\n\r\nimport reduceFilename from \"../tools/reduce-filename\";\r\nimport extractVideoInformations from \"../tools/ffprobe\";\r\nimport Quality from \"./Quality\";\r\nimport Codec from \"./Codec\";\r\nimport Flag from \"./Flag\";\r\nimport searchOnTMDB from \"../tools/tmdb\";\r\nimport { ipcRenderer, shell } from \"electron\";\r\nimport { Col } from \"antd\";\r\nimport styled from \"styled-components\";\r\nimport { PlaySquareFilled } from \"@ant-design/icons\";\r\nimport notfoundSrc from \"../images/flagging/notfound.jpg\";\r\nimport db from \"../services/db\";\r\nimport store from \"../services/store\";\r\n\r\n\r\nconst StyledVideo = styled(Col)`\r\n  position: relative;\r\n\r\n  &:hover {\r\n    .info {\r\n      .extra {\r\n        background-color: rgba(0, 0, 0, 0.8);\r\n        .description {\r\n          display: block;\r\n          padding-bottom: 1rem;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  .info {\r\n    height: 100%;\r\n\r\n    .title {\r\n      position: absolute;\r\n      top: 0;\r\n      left: 0;\r\n      font-size: 1.5rem;\r\n      background-color: rgba(0, 0, 0, 0.7);\r\n      border-radius: 0 1rem 1rem 0;\r\n      color: white;\r\n      padding: 0.35rem 1rem;\r\n      span {\r\n        font-size: 1rem;\r\n      }\r\n    }\r\n\r\n    .extra {\r\n      position: absolute;\r\n      bottom: 0;\r\n      width: 100%;\r\n      background-color: rgba(0, 0, 0, 0.4);\r\n      padding: 0.35rem 1rem;\r\n\r\n      .description {\r\n        color: white;\r\n        display: none;\r\n      }\r\n    }\r\n  }\r\n\r\n  .cover {\r\n    width: 100%;\r\n    height: 100%;\r\n    background-size: cover;\r\n  }\r\n\r\n  .trakt {\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    border: none;\r\n    background: transparent;\r\n    padding: 0.4rem;\r\n    cursor: pointer;\r\n\r\n    svg {\r\n      width: 2rem;\r\n    }\r\n  }\r\n\r\n  .quality {\r\n    img {\r\n      width: 3rem;\r\n      height: 2rem;\r\n    }\r\n  }\r\n\r\n  .icon {\r\n    color: white;\r\n    padding-right: 1rem;\r\n  }\r\n\r\n  .play {\r\n    color: white;\r\n    position: absolute;\r\n    z-index: 10;\r\n    bottom: 0;\r\n    right: 0;\r\n    padding: 1rem;\r\n\r\n    svg {\r\n      width: 2rem;\r\n      height: 2rem;\r\n    }\r\n  }\r\n`;\r\n\r\nconst filterNoNamedLanguages = (languages) =>\r\n  languages.filter((stream) => stream.language);\r\n\r\nconst renderAudio = (languages) => (\r\n  <div className=\"languages audio\">\r\n    <SoundOutlined className=\"icon\" />\r\n    {languages.map((stream, idx) => (\r\n      <Flag\r\n        // eslint-disable-next-line react/no-array-index-key\r\n        key={`${stream.language}_${stream.codecName}_${idx}`}\r\n        language={stream.language}\r\n        title={stream.codecName}\r\n      />\r\n    ))}\r\n  </div>\r\n);\r\n\r\nconst renderSubtitle = (languages) => (\r\n  <div className=\"languages subtitle\">\r\n    <MessageOutlined className=\"icon\" />\r\n    {languages.map((stream, idx) => (\r\n      <Flag\r\n        // eslint-disable-next-line react/no-array-index-key\r\n        key={`${stream.language}_${stream.title}_${idx}`}\r\n        language={stream.language}\r\n        title={stream.title}\r\n      />\r\n    ))}\r\n  </div>\r\n);\r\n\r\nconst renderInformations = (informations) => (\r\n  <>\r\n    <span className=\"title\">\r\n      {informations.title}{\" \"}\r\n      <span>({informations?.tmdb?.release_date?.slice(0, 4)})</span>\r\n    </span>\r\n    <div className=\"extra\">\r\n      <div className=\"description\">{informations?.tmdb?.overview}</div>\r\n      <div className=\"audio\">\r\n        {informations.audio.length ? renderAudio(informations.audio) : null}\r\n      </div>\r\n      {informations.subtitle.length\r\n        ? renderSubtitle(informations.subtitle)\r\n        : null}\r\n      <div className=\"quality\">\r\n        <Quality value={informations.quality} />\r\n        <Codec value={informations.codecName} />\r\n      </div>\r\n    </div>\r\n  </>\r\n);\r\n\r\n// eslint-disable-next-line camelcase\r\nconst renderCover = (informations) => (\r\n  <img\r\n    className=\"cover\"\r\n    alt={informations?.title}\r\n    src={informations?.tmdb?.backdrop_path || notfoundSrc}\r\n  />\r\n);\r\n\r\nconst VideoFile = ({ dirent, onDoubleClick }) => {\r\n  const [info, setInfo] = useState(null);\r\n  const filePath = dirent.fullPath;\r\n\r\n  useEffect(() => {\r\n    const update = async () => {\r\n      console.log(dirent);\r\n      let info = await store.getMovieInfo(dirent.fullPath, dirent.altTitle);\r\n      setInfo(info);\r\n    };\r\n\r\n    update();\r\n  }, []);\r\n\r\n  const handleOpenTraktr = () => {\r\n    shell.openExternal(\r\n      `https://trakt.tv/search?query=${info?.title?.split(\" \").join(\"+\")}`\r\n    );\r\n  };\r\n\r\n  const handleOpenVideo = () => {\r\n    ipcRenderer.send(\"open-file\", dirent.fullPath);\r\n  };\r\n\r\n  const name = reduceFilename(basename(filePath));\r\n\r\n  return (\r\n    <StyledVideo xs={24} lg={12} xl={8} xxl={6} onDoubleClick={handleOpenVideo}>\r\n      {renderCover(info)}\r\n      <div className=\"info\">\r\n        {info ? renderInformations(info) : <span>{name}</span>}\r\n        {info?.title && (\r\n          <button className=\"trakt\" onClick={handleOpenTraktr}>\r\n            {trakticon}\r\n          </button>\r\n        )}\r\n        <PlaySquareFilled className=\"play\" onClick={handleOpenVideo} />\r\n      </div>\r\n    </StyledVideo>\r\n  );\r\n};\r\n\r\nVideoFile.defaultProps = {\r\n  filePath: \"\",\r\n  onDoubleClick: () => null,\r\n};\r\n\r\nexport default VideoFile;\r\n"
        }
    ]
}